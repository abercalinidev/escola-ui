<div class="container">

    <!-- Breadcrumb -->
  <div class="breadcrumb mb-3">
    <i class="pi pi-home mr-2 text-gray-500"></i>
    <span class="text-gray-500">In√≠cio</span>
    <span class="mx-2 text-gray-400">/</span>
    <span class="text-gray-700 font-semibold">Representantes</span>
  </div>

  <!-- T√≠tulo + Icon -->
  <div class="page-header mb-4 flex align-items-center">
    <i class="pi pi-users text-3xl text-primary mr-3"></i>
    <div>
      <h1 class="page-title m-0">Representantes</h1>
      <p class="page-subtitle m-0">
        Gerencie aqui todos os representantes cadastrados no sistema.
      </p>
    </div>
  </div>

  <!-- Cards de Resumo -->
  <div class="grid mb-4">
    <div class="col-12 md:col-4">
      <div class="summary-card p-3 shadow-2 border-round-lg">
        <div class="flex align-items-center">
          <i class="pi pi-users text-2xl text-primary mr-3"></i>
          <div>
            <h3 class="summary-title">Total cadastrados</h3>
            <p class="summary-value">{{ representantes.length || 0 }}</p>
          </div>
        </div>
      </div>
    </div>

    <div class="col-12 md:col-4">
      <div class="summary-card p-3 shadow-2 border-round-lg">
        <div class="flex align-items-center">
          <i class="pi pi-check-circle text-2xl text-green-500 mr-3"></i>
          <div>
            <h3 class="summary-title">Ativos</h3>
            <p class="summary-value">{{ ativosCount || 0 }}</p>
          </div>
        </div>
      </div>
    </div>

    <div class="col-12 md:col-4">
      <div class="summary-card p-3 shadow-2 border-round-lg">
        <div class="flex align-items-center">
          <i class="pi pi-clock text-2xl text-orange-500 mr-3"></i>
          <div>
            <h3 class="summary-title">Cadastrados Hoje</h3>
            <p class="summary-value">{{ cadastradosHojeCount || 0 }}</p>
          </div>
        </div>
      </div>
    </div>
  </div>

    <!-- üîπ TOOLBAR MODERNA -->
    <p-toolbar styleClass="mb-4 surface-card shadow-2 border-round-lg p-3">
        <ng-template #start>
            <div class="flex gap-2">
                <p-button label="Novo" icon="pi pi-plus" styleClass="p-button-success" 
                    routerLink="/representante-cadastro"></p-button>

                <p-button 
                    label="Editar" 
                    icon="pi pi-pencil"
                    severity="info"
                    [disabled]="!representanteSelecionado"
                    (onClick)="prepararEdicaoRepresentante()">
                </p-button>
            </div>
        </ng-template>
    </p-toolbar>

   <!-- üîπ TABELA PROFISSIONAL -->
<p-card class="shadow-3 border-round-lg">
    <p-table 
        [value]="representantes"
        [paginator]="true"
        [rows]="10"
        [rowsPerPageOptions]="[10, 20, 30]"
        selectionMode="single"
        [(selection)]="representanteSelecionado"
        dataKey="id"
        responsiveLayout="stack"
        [tableStyle]="{ 'min-width': '60rem' }"
        [globalFilterFields]="[
            'id',
            'nome',
            'situacao',
            'sobrenome',
            'celular',
            'email',
            'endereco.cidade',
            'endereco.bairro'
        ]"
        #dt1>

        <!-- üîπ Busca Global -->
        <ng-template pTemplate="caption">
            <div class="flex justify-content-end">
                <p-iconfield iconPosition="left">
                    <p-inputicon><i class="pi pi-search"></i></p-inputicon>
                    <input 
                        pInputText 
                        type="text" 
                        #textInput 
                        (input)="dt1.filterGlobal(textInput.value, 'contains')" 
                        placeholder="Filtro Global"/>
                </p-iconfield>
            </div>
        </ng-template>

        <!-- üîπ Cabe√ßalho -->
        <ng-template pTemplate="header">
            <tr>
                <th pSortableColumn="id">ID <p-sortIcon field="id"/></th>
                <th pSortableColumn="nome">Nome <p-sortIcon field="nome"/></th>
                <th pSortableColumn="celular">Celular <p-sortIcon field="celular"/></th>
                <th pSortableColumn="email">Email <p-sortIcon field="email"/></th>
                <th pSortableColumn="dataCadastro">Data Cadastro <p-sortIcon field="dataCadastro"/></th>
                <th pSortableColumn="endereco.cidade">Cidade <p-sortIcon field="endereco.cidade"/></th>
                <th pSortableColumn="endereco.rua">Rua <p-sortIcon field="endereco.rua"/></th>
            </tr>
        </ng-template>

        <!-- üîπ Corpo -->
        <ng-template pTemplate="body" let-r>
            <tr [pSelectableRow]="r">
                
            <!-- ID + status bolinha -->
            <td>
                <span 
                    class="status-dot"
                    [ngClass]="r.situacao === 'ATIVO' ? 'active' : 'inactive'"
                    (click)="toggleSituacao(r)"
                    pTooltip="{{ r.situacao === 'ATIVO' ? 'Clique para inativar' : 'Clique para ativar' }}"
                    tooltipPosition="top">
                </span>
                {{ r.id }}
            </td>

                <td>{{ r.nome }} {{ r.sobrenome }}</td>
                <td>{{ r.celular }}</td>
                <td>{{ r.email }}</td>
                <td>{{ r.dataCadastro }}</td>
                <td>{{ r.endereco.cidade }}</td>
                <td>{{ r.endereco.rua }}</td>
            </tr>
        </ng-template>

    </p-table>
</p-card>

    <p-toast></p-toast>
    <p-confirmdialog></p-confirmdialog>

</div>
